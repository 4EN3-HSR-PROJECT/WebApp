<!--
	This file is only part of a full html page and is to be
	included in another page (via php include, etc.) in order
	to provide full functionality.
-->

<script>
function getDropdown(div,queryloc,param = "") {
	// Initialize page getters
	var sqlconnect;
	var dropdown;
	if (window.XMLHttpRequest) {
		sqlconnect = new XMLHttpRequest();
		dropdown = new XMLHttpRequest();
	} else {
		sqlconnect = new ActiveXObject("Microsoft.XMLHTTP");
		dropdown = new ActiveXObject("Microsoft.XMLHTTP");
	}
	
	// Function to be run upon sqlConenctor response
	var serialArray;
	sqlconnect.onreadystatechange = function() {
		if (sqlconnect.readyState == 4 && sqlconnect.status == 200) {
			// Send request for dropdown
			serialarray = sqlconnect.responseText;
			var address = "dropdown.php";
			var variables = "array=" + serialarray;
			if (param != "") {
				variables += "&" + param;
			}
			dropdown.open("POST",address,true);
			dropdown.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			dropdown.send(variables);
		}
	}
	
	// Function to be run upon dropdown response
	dropdown.onreadystatechange = function() {
		if (dropdown.readyState == 4 && dropdown.status == 200) {
			document.getElementById(div).innerHTML = dropdown.responseText;
		}
	}
	
	// Send request for sql array
	if (param == "") {
		sqlconnect.open("GET",queryloc,true);
	} else {
		sqlconnect.open("GET",queryloc + "?" + param,true);
	}
	sqlconnect.send();
}
</script>





<div style="background: url(WebAppBg.jpg) black no-repeat scroll left top; background-size: cover;" id="bus" data-url="bus" data-role="page" data-theme="a">
<div data-role="header">
<h1>Find a Bus</h1>
<div data-role="navbar">
<ul>
<li><a href="#bus" class="ui-btn-active">Bus</a></li>
<li><a href="#main">Information</a></li>
<li><a href="#taxi">Taxi</a></li>
</ul>
</div>

</div>

<div data-role="content">

<form id="form_tw40" method="POST">

<div data-role="fieldcontain">
<label for="sel_tw41"></label>
<select name="bus_stop" id="bus_stop" data-theme="c">
	<option value="" style="display:none;">Loading...</option>
</select>
</div>

<div data-role="fieldcontain">
<label for="sel_tw42"></label>
<select name="bus_route" id="bus_route" data-theme="c">
	<option value="" style="display:none;">Loading...</option>
</select>
</div>

<input type="submit" value="Check Bus Time"/>
</form>

<script>
	getDropdown("bus_stop","sql/getStops.php","request=stops");
	getDropdown("bus_route","sql/getRoutes.php","request=routes");
</script>

</div></div>